<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONT Monitoring Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        .header-content h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 5px;
        }
        .header-content p {
            color: #666;
            font-size: 1.1em;
        }
        .header-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 239, 125, 0.4);
        }
        .btn-danger {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(235, 51, 73, 0.4);
        }
        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .btn-small {
            padding: 8px 15px;
            font-size: 0.9em;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        .stat-card .value {
            font-size: 2.8em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .search-filter {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .search-filter input, .search-filter select {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1em;
            transition: all 0.3s;
        }
        .search-filter input:focus, .search-filter select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .table-container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 1px;
        }
        th:first-child {
            border-radius: 10px 0 0 0;
        }
        th:last-child {
            border-radius: 0 10px 0 0;
        }
        td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        tr:hover {
            background: #f8f9ff;
        }
        .status-badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        .badge-online {
            background: #d4edda;
            color: #155724;
        }
        .badge-offline {
            background: #f8d7da;
            color: #721c24;
        }
        .badge-maintenance {
            background: #fff3cd;
            color: #856404;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            padding: 35px;
            border-radius: 25px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }
        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        .modal-header h2 {
            color: #1e3c72;
            font-size: 1.8em;
        }
        .close-btn {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: #666;
            transition: color 0.3s;
        }
        .close-btn:hover {
            color: #eb3349;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 0.95em;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.3em;
        }
        .loading::after {
            content: '';
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 15px;
            vertical-align: middle;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        .empty-state .icon {
            font-size: 5em;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        .location-group {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .location-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #667eea;
        }
        .location-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #1e3c72;
        }
        .location-count {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }
        .alert.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        @keyframes slideDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üåê ONT Monitoring Dashboard</h1>
                <p>Sistem Manajemen Data ONT Real-time</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-success" onclick="openAddModal()">
                    ‚ûï Tambah Data ONT
                </button>
                <button class="btn btn-primary" onclick="loadData()">
                    üîÑ Refresh Data
                </button>
            </div>
        </header>

        <div id="alertContainer"></div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>üìä Total ONT</h3>
                <div class="value" id="totalONT">0</div>
            </div>
            <div class="stat-card">
                <h3>‚úÖ Online</h3>
                <div class="value" style="color: #28a745;" id="onlineONT">0</div>
            </div>
            <div class="stat-card">
                <h3>‚ùå Offline</h3>
                <div class="value" style="color: #dc3545;" id="offlineONT">0</div>
            </div>
            <div class="stat-card">
                <h3>üìç Lokasi</h3>
                <div class="value" id="totalLocations">0</div>
            </div>
        </div>

        <div class="search-filter">
            <input type="text" id="searchInput" placeholder="üîç Cari berdasarkan nama, lokasi, atau ID ONT..." onkeyup="filterData()">
            <select id="locationFilter" onchange="filterData()">
                <option value="">üìç Semua Lokasi</option>
            </select>
            <select id="statusFilter" onchange="filterData()">
                <option value="">üìä Semua Status</option>
                <option value="online">‚úÖ Online</option>
                <option value="offline">‚ùå Offline</option>
                <option value="maintenance">üîß Maintenance</option>
            </select>
        </div>

        <div id="loadingMessage" class="loading">Memuat data...</div>
        
        <div id="dataContainer" style="display: none;"></div>
    </div>

    <!-- Modal Add/Edit -->
    <div id="ontModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Tambah Data ONT</h2>
                <button class="close-btn" onclick="closeModal()">√ó</button>
            </div>
            <form id="ontForm">
                <input type="hidden" id="editIndex">
                <div class="form-group">
                    <label>ID ONT *</label>
                    <input type="text" id="ontId" required placeholder="Contoh: ONT-001">
                </div>
                <div class="form-group">
                    <label>Nama Pelanggan *</label>
                    <input type="text" id="customerName" required placeholder="Contoh: PT. Telkom Indonesia">
                </div>
                <div class="form-group">
                    <label>Lokasi *</label>
                    <select id="location" required>
                        <option value="">-- Pilih Lokasi --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Alamat Lengkap</label>
                    <textarea id="address" rows="3" placeholder="Masukkan alamat lengkap..."></textarea>
                </div>
                <div class="form-group">
                    <label>Status *</label>
                    <select id="status" required>
                        <option value="online">‚úÖ Online</option>
                        <option value="offline">‚ùå Offline</option>
                        <option value="maintenance">üîß Maintenance</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Signal Strength (dBm)</label>
                    <input type="text" id="signal" placeholder="Contoh: -25">
                </div>
                <div class="form-group">
                    <label>Kecepatan (Mbps)</label>
                    <input type="text" id="speed" placeholder="Contoh: 100">
                </div>
                <div class="form-group">
                    <label>Catatan</label>
                    <textarea id="notes" rows="2" placeholder="Catatan tambahan..."></textarea>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 25px;">
                    <button type="submit" class="btn btn-success" style="flex: 1;">üíæ Simpan</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()" style="flex: 1;">‚ùå Batal</button>
                </div>
            </form>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <button class="btn btn-primary" onclick="downloadPDF()">
    üìÑ Download PDF
</button>
    
    <script>
        let allData = [];
        let filteredData = [];
        let sortColumn = '';
        let sortDirection = 'asc';

        const SHEET_ID = '1LtXcUBrG5kfT8lzs62QZ8v74fNiEjD9hDG6OVFX4Kfo';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

        async function loadData() {
            const loadingMessage = document.getElementById('loadingMessage');
            const dataContainer = document.getElementById('dataContainer');
            
            loadingMessage.style.display = 'block';
            dataContainer.style.display = 'none';

            try {
                const response = await fetch(SHEET_URL);
                const text = await response.text();
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                const rows = jsonData.table.rows;
                
                if (rows.length < 2) {
                    showAlert('Tidak ada data di spreadsheet', 'error');
                    return;
                }

                allData = rows.slice(1).map((row, index) => ({
                    index: index,
                    id: row.c[0]?.v || 'N/A',
                    customerName: row.c[1]?.v || 'N/A',
                    location: row.c[2]?.v || 'N/A',
                    address: row.c[3]?.v || '-',
                    status: row.c[4]?.v || 'offline',
                    signal: row.c[5]?.v || '-',
                    speed: row.c[6]?.v || '-',
                    notes: row.c[7]?.v || '-',
                    lastUpdate: row.c[8]?.v || new Date().toLocaleString()
                }));

                filteredData = [...allData];
                updateStats();
                updateLocationFilter();
                updateLocationDropdown();
                renderData();
                
                loadingMessage.style.display = 'none';
                dataContainer.style.display = 'block';

            } catch (error) {
                console.error('Error:', error);
                showAlert('Error memuat data. Pastikan Google Sheet sudah public!', 'error');
                loadingMessage.style.display = 'none';
            }
        }

        function updateStats() {
            const total = allData.length;
            const online = allData.filter(d => d.status.toLowerCase() === 'online').length;
            const offline = allData.filter(d => d.status.toLowerCase() === 'offline').length;
            const locations = [...new Set(allData.map(d => d.location))].length;

            document.getElementById('totalONT').textContent = total;
            document.getElementById('onlineONT').textContent = online;
            document.getElementById('offlineONT').textContent = offline;
            document.getElementById('totalLocations').textContent = locations;
        }

        function updateLocationFilter() {
            const locations = [...new Set(allData.map(d => d.location))].sort();
            const select = document.getElementById('locationFilter');
            select.innerHTML = '<option value="">üìç Semua Lokasi</option>';
            locations.forEach(loc => {
                select.innerHTML += `<option value="${loc}">${loc}</option>`;
            });
        }

        function updateLocationDropdown() {
            const locations = [...new Set(allData.map(d => d.location))].sort();
            const select = document.getElementById('location');
            select.innerHTML = '<option value="">-- Pilih Lokasi --</option>';
            locations.forEach(loc => {
                select.innerHTML += `<option value="${loc}">${loc}</option>`;
            });
        }

        function filterData() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const location = document.getElementById('locationFilter').value;
            const status = document.getElementById('statusFilter').value;

            filteredData = allData.filter(d => {
                const matchSearch = !search || 
                    d.id.toLowerCase().includes(search) ||
                    d.customerName.toLowerCase().includes(search) ||
                    d.location.toLowerCase().includes(search);
                const matchLocation = !location || d.location === location;
                const matchStatus = !status || d.status.toLowerCase() === status;
                
                return matchSearch && matchLocation && matchStatus;
            });

            renderData();
        }
        function sortData(column) {
    if (sortColumn === column) {
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
    } else {
        sortColumn = column;
        sortDirection = 'asc';
    }

    filteredData.sort((a, b) => {
        let valA = a[column];
        let valB = b[column];

        // Handle numeric values
        if (column === 'signal' || column === 'speed') {
            valA = parseFloat(valA) || 0;
            valB = parseFloat(valB) || 0;
        } else {
            valA = String(valA).toLowerCase();
            valB = String(valB).toLowerCase();
        }

        if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
        if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
        return 0;
    });

    renderData();
}

        function getSortIcon(column) {
            if (sortColumn !== column) return '‚ÜïÔ∏è';
            return sortDirection === 'asc' ? '‚Üë' : '‚Üì';
        }

        function renderData() {
            const container = document.getElementById('dataContainer');
            
            if (filteredData.length === 0) {
                container.innerHTML = `
                    <div class="table-container">
                        <div class="empty-state">
                            <div class="icon">üì≠</div>
                            <h2>Tidak ada data ditemukan</h2>
                            <p>Coba ubah filter atau tambah data baru</p>
                        </div>
                    </div>
                `;
                return;
            }

            const groupedData = {};
            filteredData.forEach(d => {
                if (!groupedData[d.location]) {
                    groupedData[d.location] = [];
                }
                groupedData[d.location].push(d);
            });

            let html = '';
            Object.keys(groupedData).sort().forEach(location => {
                const data = groupedData[location];
                html += `
                    <div class="location-group">
                        <div class="location-header">
                            <span class="location-title">üìç ${location}</span>
                            <span class="location-count">${data.length} ONT</span>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                     <tr>
                                        <th>No</th>
                                        <th onclick="sortData('id')" style="cursor: pointer;">ID ONT ${getSortIcon('id')}</th>
                                        <th onclick="sortData('customerName')" style="cursor: pointer;">Nama Pelanggan ${getSortIcon('customerName')}</th>
                                        <th>Alamat</th>
                                        <th onclick="sortData('status')" style="cursor: pointer;">Status ${getSortIcon('status')}</th>
                                        <th onclick="sortData('signal')" style="cursor: pointer;">Signal ${getSortIcon('signal')}</th>
                                        <th onclick="sortData('speed')" style="cursor: pointer;">Kecepatan ${getSortIcon('speed')}</th>
                                        <th onclick="sortData('lastUpdate')" style="cursor: pointer;">Update Terakhir ${getSortIcon('lastUpdate')}</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.map((d, idx) => `
                                        <tr>
                                            <td>${idx + 1}</td>
                                            <td><strong>${d.id}</strong></td>
                                            <td>${d.customerName}</td>
                                            <td>${d.address}</td>
                                            <td><span class="status-badge badge-${d.status.toLowerCase()}">${d.status.toUpperCase()}</span></td>
                                            <td>${d.signal} dBm</td>
                                            <td>${d.speed} Mbps</td>
                                            <td>${d.lastUpdate}</td>
                                            <td>
                                                <button class="btn btn-warning btn-small" onclick="editData(${d.index})">‚úèÔ∏è Edit</button>
                                                <button class="btn btn-danger btn-small" onclick="deleteData(${d.index})">üóëÔ∏è Hapus</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'Tambah Data ONT';
            document.getElementById('ontForm').reset();
            document.getElementById('editIndex').value = '';
            updateLocationDropdown();
            document.getElementById('ontModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('ontModal').classList.remove('active');
        }

        function editData(index) {
            const data = allData[index];
            document.getElementById('modalTitle').textContent = 'Edit Data ONT';
            document.getElementById('editIndex').value = index;
            document.getElementById('ontId').value = data.id;
            document.getElementById('customerName').value = data.customerName;
            updateLocationDropdown();
            document.getElementById('location').value = data.location;
            document.getElementById('address').value = data.address;
            document.getElementById('status').value = data.status.toLowerCase();
            document.getElementById('signal').value = data.signal;
            document.getElementById('speed').value = data.speed;
            document.getElementById('notes').value = data.notes;
            document.getElementById('ontModal').classList.add('active');
        }

        function deleteData(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                allData.splice(index, 0);
                allData = allData.map((d, i) => ({...d, index: i}));
                filteredData = [...allData];
                updateStats();
                renderData();
                showAlert('Data berhasil dihapus! (Simulasi)', 'success');
            }
        }

        document.getElementById('ontForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const editIndex = document.getElementById('editIndex').value;
            const newData = {
                id: document.getElementById('ontId').value,
                customerName: document.getElementById('customerName').value,
                location: document.getElementById('location').value,
                address: document.getElementById('address').value,
                status: document.getElementById('status').value,
                signal: document.getElementById('signal').value,
                speed: document.getElementById('speed').value,
                notes: document.getElementById('notes').value,
                lastUpdate: new Date().toLocaleString()
            };

            if (editIndex === '') {
                newData.index = allData.length;
                allData.push(newData);
                showAlert('Data berhasil ditambahkan! (Simulasi)', 'success');
            } else {
                allData[editIndex] = {...allData[editIndex], ...newData};
                showAlert('Data berhasil diupdate! (Simulasi)', 'success');
            }

            filteredData = [...allData];
            updateStats();
            updateLocationFilter();
            updateLocationDropdown();
            renderData();
            closeModal();
        });

        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            const icon = type === 'success' ? '‚úÖ' : '‚ùå';
            
            const alert = document.createElement('div');
            alert.className = `alert ${alertClass} show`;
            alert.innerHTML = `${icon} ${message}`;
            
            alertContainer.appendChild(alert);
            
            setTimeout(() => {
                alert.classList.remove('show');
                setTimeout(() => alert.remove(), 300);
            }, 3000);
        }
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4'); // landscape orientation
        
            // Header
            doc.setFontSize(18);
            doc.setTextColor(30, 60, 114);
            doc.text('ONT Monitoring Dashboard', 14, 15);
            
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text(`Generated: ${new Date().toLocaleString()}`, 14, 22);
            
            // Stats
            doc.setFontSize(11);
            doc.setTextColor(0, 0, 0);
            const stats = `Total ONT: ${allData.length} | Online: ${allData.filter(d => d.status.toLowerCase() === 'online').length} | Offline: ${allData.filter(d => d.status.toLowerCase() === 'offline').length}`;
            doc.text(stats, 14, 29);
        
            // Table
            const tableData = filteredData.map((d, idx) => [
                idx + 1,
                d.id,
                d.customerName,
                d.location,
                d.address,
                d.status.toUpperCase(),
                d.signal + ' dBm',
                d.speed + ' Mbps',
                d.lastUpdate
            ]);
        
            doc.autoTable({
                startY: 35,
                head: [['No', 'ID ONT', 'Pelanggan', 'Lokasi', 'Alamat', 'Status', 'Signal', 'Kecepatan', 'Update']],
                body: tableData,
                theme: 'striped',
                headStyles: {
                    fillColor: [102, 126, 234],
                    textColor: 255,
                    fontStyle: 'bold'
                },
                styles: {
                    fontSize: 8,
                    cellPadding: 2
                },
                columnStyles: {
                    0: { cellWidth: 10 },
                    1: { cellWidth: 25 },
                    2: { cellWidth: 40 },
                    3: { cellWidth: 30 },
                    4: { cellWidth: 45 },
                    5: { cellWidth: 20 },
                    6: { cellWidth: 20 },
                    7: { cellWidth: 22 },
                    8: { cellWidth: 35 }
                }
            });

    // Footer
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setTextColor(150);
        doc.text(`Halaman ${i} dari ${pageCount}`, doc.internal.pageSize.width / 2, doc.internal.pageSize.height - 10, { align: 'center' });
    }

    doc.save(`ONT-Monitoring-${new Date().toISOString().split('T')[0]}.pdf`);
    showAlert('PDF berhasil didownload!', 'success');
}
        loadData();
    </script>
</body>
</html>


